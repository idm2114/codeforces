the code for this is horribly convoluted
there's definitely an easier way to solve this problem
